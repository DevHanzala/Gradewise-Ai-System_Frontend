import{K as A,O as u,h as C,u as E,r as h,j as e,L as $,C as i,b as c,N as F,S as I,s as p,ac as Q,E as L,k as T,V as v,ad as V,g as z}from"./index-BE97Blc-.js";const g="https://gradeadmin.techmiresolutions.com/api",B=A((t,b)=>({loading:!1,error:null,assessments:[],students:[],selectedAssessmentId:null,selectedStudentId:null,studentQuestions:[],fetchAssessments:async()=>{t({loading:!0,error:null,students:[],selectedAssessmentId:null,selectedStudentId:null,studentQuestions:[]});try{const n=localStorage.getItem("token");if(!n)throw new Error("No authentication token found");console.log(`ðŸ” Fetching assessments from ${g}/instructor-analytics/assessments`);const r=await u.get(`${g}/instructor-analytics/assessments`,{headers:{Authorization:`Bearer ${n}`}});if(r.data.success)t({assessments:r.data.data||[],error:null});else throw new Error(r.data.message||"Failed to fetch assessments")}catch(n){console.error("âŒ Error fetching assessments:",n),t({error:n.message||"Failed to fetch assessments"})}finally{t({loading:!1})}},fetchAssessmentStudents:async n=>{t({loading:!0,error:null,students:[],selectedStudentId:null,studentQuestions:[]});try{const r=localStorage.getItem("token");if(!r)throw new Error("No authentication token found");const a=await u.get(`${g}/instructor-analytics/assessment/${n}/students`,{headers:{Authorization:`Bearer ${r}`}});if(a.data.success)t({students:a.data.data||[],selectedAssessmentId:n});else throw new Error(a.data.message||"Failed to fetch students")}catch(r){console.error("âŒ Error fetching students:",r),t({error:r.message||"Failed to fetch students"})}finally{t({loading:!1})}},fetchStudentQuestions:async(n,r)=>{t({loading:!0,error:null,studentQuestions:[],selectedStudentId:null});try{const a=localStorage.getItem("token");if(!a)throw new Error("No authentication token found");const l=await u.get(`${g}/instructor-analytics/assessment/${n}/student/${r}/questions`,{headers:{Authorization:`Bearer ${a}`}});if(l.data.success)t({studentQuestions:l.data.data||[],selectedStudentId:r,loading:!1});else throw new Error(l.data.message)}catch(a){console.error("Error fetching student questions:",a),t({error:a.message||"Failed to load answers",studentQuestions:[],selectedStudentId:null,loading:!1})}}}));function M(){const{assessmentId:t}=C(),b=E(),{loading:n,error:r,assessments:a,students:l,fetchAssessments:f,fetchAssessmentStudents:j,fetchStudentQuestions:N,studentQuestions:y,selectedStudentId:_}=B(),[k,w]=h.useState(null);if(h.useEffect(()=>{f()},[f]),h.useEffect(()=>{if(t&&!isNaN(t)&&t!==":assessmentId"){j(t);const d=a.find(o=>o.id===Number(t));w(d||null)}else w(null)},[t,a,j]),n)return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-blue-50 flex flex-col items-center justify-center",children:[e.jsx($,{size:"lg",type:"gradient"}),e.jsx("p",{className:"mt-4 text-gray-600 font-medium",children:"Loading analytics..."})]});if(r)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-blue-50 flex items-center justify-center",children:e.jsx(i,{className:"max-w-md shadow-lg border-0",children:e.jsxs(c,{className:"p-8 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"âš ï¸"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Error"}),e.jsx("p",{className:"text-red-600 font-medium",children:r})]})})});const S=(s,d,o)=>{if(!d)return!1;let x=String(s||"").trim(),m=String(d||"").trim();return x=x.replace(/\\"/g,'"').replace(/^["'\s]+|["'\s]+$/g,"").trim(),m=m.replace(/\\"/g,'"').replace(/^["'\s]+|["'\s]+$/g,"").trim(),x.toLowerCase()===m.toLowerCase()};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-blue-50",children:[e.jsx(F,{}),e.jsxs("div",{className:"w-full mx-auto px-4 sm:px-6 lg:px-8 xl:px-10 py-8 sm:py-12 max-w-7xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-2 flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-indigo-100 to-purple-100 rounded-xl flex items-center justify-center",children:e.jsx(I,{className:"text-indigo-600 text-xl"})}),"Assessment Analytics"]}),e.jsx("p",{className:"text-gray-600 ml-0 sm:ml-15",children:"Monitor student performance and assessment results"})]}),e.jsxs(i,{className:"shadow-md hover:shadow-lg transition-shadow duration-300 mb-8 border-0",children:[e.jsx(p,{className:"bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-t-lg",children:e.jsxs("h3",{className:"text-xl font-semibold flex items-center gap-2",children:[e.jsx(Q,{})," My Executed Assessments"]})}),e.jsx(c,{className:"p-6 sm:p-8",children:a.length>0?e.jsx("div",{className:"space-y-4",children:a.map(s=>e.jsx("div",{onClick:()=>b(`/instructor/assessments/${s.id}/analytics`),className:`p-5 sm:p-6 rounded-xl border-2 cursor-pointer transition-all duration-200 ${s.id===Number(t)?"border-indigo-500 bg-gradient-to-r from-indigo-50 to-purple-50 shadow-md scale-[1.02]":"border-gray-200 bg-white hover:border-indigo-300 hover:shadow-md"}`,children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-lg sm:text-xl font-bold text-gray-900 mb-2",children:s.title}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(L,{className:"mr-2 text-indigo-500"}),"Created: ",new Date(s.created_at).toLocaleDateString()]})]}),e.jsxs("div",{className:"text-center sm:text-right bg-white rounded-lg px-6 py-3 border-2 border-indigo-200",children:[e.jsxs("div",{className:"text-3xl font-bold text-indigo-600 flex items-center justify-center sm:justify-end gap-2",children:[e.jsx(T,{}),s.completed_attempts]}),e.jsx("p",{className:"text-sm text-gray-600 font-medium mt-1",children:"Completed"})]})]})},s.id))}):e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"text-7xl mb-6 opacity-30",children:"ðŸ“Š"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"No Executed Assessments"}),e.jsx("p",{className:"text-gray-600",children:"Execute an assessment to see analytics here"})]})})]}),t&&!isNaN(t)&&t!==":assessmentId"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden lg:block mb-10",children:e.jsxs(i,{className:"shadow-md hover:shadow-lg transition-shadow duration-300 border-0 overflow-hidden",children:[e.jsx(p,{className:"bg-gradient-to-r from-blue-600 to-indigo-600 text-white",children:e.jsxs("h3",{className:"text-xl font-semibold",children:["Student Results â€” ",k?.title]})}),e.jsx(c,{className:"p-0",children:l.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gradient-to-r from-gray-100 to-blue-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Student"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Questions"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Correct"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Score"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Time Used"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-bold text-gray-700 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:l.map(s=>e.jsxs("tr",{className:"hover:bg-blue-50 transition-colors duration-150",children:[e.jsx("td",{className:"px-6 py-4 font-semibold text-gray-900",children:s.name||`Student ${s.student_id}`}),e.jsx("td",{className:"px-6 py-4 text-gray-700 font-medium",children:s.total_questions||0}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"bg-green-100 text-green-700 px-3 py-1 rounded-full font-bold text-sm",children:s.correct_answers||0})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:"bg-indigo-100 text-indigo-700 px-3 py-1 rounded-full font-bold text-sm",children:[s.percentage,"%"]})}),e.jsx("td",{className:"px-6 py-4 text-gray-700",children:s.time_used}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("button",{onClick:()=>N(t,s.student_id),className:"px-4 py-2 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg hover:from-indigo-700 hover:to-purple-700 text-sm font-semibold flex items-center gap-2 transition-all duration-200 shadow-sm hover:shadow-md",children:[e.jsx(v,{})," View Answers"]})})]},s.student_id))})]})}):e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"text-6xl mb-4 opacity-30",children:"ðŸ‘¥"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"No students have completed this assessment"})]})})]})}),e.jsx("div",{className:"lg:hidden space-y-4 mb-10",children:l.length>0?l.map(s=>e.jsx(i,{className:"shadow-md hover:shadow-lg transition-all duration-200 border-0",children:e.jsxs(c,{className:"p-5",children:[e.jsx("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg p-4 mb-4 border-2 border-indigo-200",children:e.jsx("h4",{className:"font-bold text-lg text-gray-900",children:s.name||`Student ${s.student_id}`})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-4",children:[e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("strong",{className:"text-gray-600 text-xs uppercase block mb-1",children:"Questions"}),e.jsx("span",{className:"text-lg font-bold text-gray-900",children:s.total_questions})]}),e.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[e.jsx("strong",{className:"text-gray-600 text-xs uppercase block mb-1",children:"Correct"}),e.jsx("span",{className:"text-lg font-bold text-green-600",children:s.correct_answers})]}),e.jsxs("div",{className:"bg-indigo-50 p-3 rounded-lg",children:[e.jsx("strong",{className:"text-gray-600 text-xs uppercase block mb-1",children:"Score"}),e.jsxs("span",{className:"text-lg font-bold text-indigo-600",children:[s.percentage,"%"]})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("strong",{className:"text-gray-600 text-xs uppercase block mb-1",children:"Time"}),e.jsx("span",{className:"text-lg font-bold text-gray-900",children:s.time_used})]})]}),e.jsxs("button",{onClick:()=>N(t,s.student_id),className:"w-full py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg font-semibold hover:from-indigo-700 hover:to-purple-700 flex items-center justify-center gap-2 transition-all duration-200 shadow-md hover:shadow-lg",children:[e.jsx(v,{})," View Detailed Answers"]})]})},s.student_id)):e.jsx(i,{className:"shadow-md border-0",children:e.jsxs(c,{className:"text-center py-16",children:[e.jsx("div",{className:"text-6xl mb-4 opacity-30",children:"ðŸ‘¥"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"No results yet"})]})})})]}),_&&y.length>0&&e.jsxs(i,{className:"shadow-md hover:shadow-lg transition-shadow duration-300 mt-10 border-0",children:[e.jsx(p,{className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-t-lg",children:e.jsxs("h3",{className:"text-xl font-semibold flex items-center gap-2",children:[e.jsx(V,{})," Student Answer Details"]})}),e.jsx(c,{className:"p-6 sm:p-8",children:e.jsx("div",{className:"space-y-6",children:y.map((s,d)=>{const o=S(s.correct_answer,s.student_answer,s.question_type);return e.jsxs("div",{className:"bg-gradient-to-br from-white to-gray-50 border-2 border-gray-200 rounded-xl p-5 sm:p-6 hover:border-purple-300 transition-all duration-200",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("h4",{className:"font-bold text-lg text-gray-900 flex items-center gap-2",children:[e.jsxs("span",{className:"bg-purple-100 text-purple-700 px-3 py-1 rounded-full text-sm",children:["Question ",s.question_order||d+1]}),e.jsxs("span",{className:"text-sm font-normal text-gray-600",children:["(",s.question_type,")"]})]})}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 mb-4",children:e.jsx("p",{className:"text-gray-900 font-medium",children:s.question_text})}),s.options&&e.jsxs("div",{className:"mb-4 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("strong",{className:"text-sm font-semibold text-gray-700 uppercase block mb-2",children:"Options:"}),e.jsx("ul",{className:"space-y-1",children:(typeof s.options=="string"?JSON.parse(s.options):s.options).map((x,m)=>e.jsxs("li",{className:"text-sm text-gray-700 flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-600 font-bold",children:"â€¢"}),e.jsx("span",{children:x})]},m))})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-green-50 border-2 border-green-200 rounded-lg p-4",children:[e.jsx("strong",{className:"text-xs font-semibold text-gray-700 uppercase block mb-2",children:"Correct Answer"}),e.jsx("p",{className:"font-bold text-lg text-green-700",children:s.question_type==="true_false"?s.correct_answer===!0||s.correct_answer==="true"?"True":"False":s.correct_answer||"N/A"})]}),e.jsxs("div",{className:`border-2 rounded-lg p-4 ${o?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[e.jsx("strong",{className:"text-xs font-semibold text-gray-700 uppercase block mb-2",children:"Student Answer"}),e.jsx("p",{className:`font-bold text-lg ${o?"text-green-700":"text-red-700"}`,children:s.question_type==="true_false"?s.student_answer===!0||s.student_answer==="true"?"True":"False":s.student_answer||"â€”"})]}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsx("strong",{className:"text-xs font-semibold text-gray-700 uppercase block mb-2",children:"Score"}),e.jsx("p",{className:"font-bold text-lg text-gray-900",children:o?s.positive_marks||1:s.score||-Math.abs(s.negative_marks||0)})]})]})]},d)})})})]})]}),e.jsx(z,{})]})}export{M as default};
